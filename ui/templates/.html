<!-- templates/jobs.html -->
<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <title>TutorSec - Automated Tutoring Secretary</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
        <script>
            // // send a request to the flask server to shut down when the page is closed
            // window.onbeforeunload = function() {
            //     navigator.sendBeacon('/shutdown');
            // };
        </script>

        <!-- Link Job Listing Script -->
        <script src="{{ url_for('static', filename='js/JobListing.js') }}"></script>

        <!-- Bootstrap JavaScript with Popper (use the bundled version) -->
        <script src="/node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    </head>

    <body>
        <!-- Jobs Container -->
        <div class="container mt-5">
            <h1 class="display-4">Available Jobs</h1>
            <p id="loadingText" class="lead">Jobs loading...</p>
            <div id="jobsContainer" class="container" style="height: 80%; overflow-y: scroll;">
        </div>

        <script>
            // add event listener to the jobs container
            document.addEventListener('DOMContentLoaded', async function() {
                const jobsContainerID = "jobsContainer";

                // fetch the jobs from the Flask server
                const jobs = await fetchJobs({
                    'agencies': ['TutorChase China', 'Oxbridge Applications', 'TutorChase', 'UniAdmissions'],
                    'filters': ['agency', 'subject', 'location']
                });

                // generate the jobs list
                generateJobsList(jobsContainerID, jobs);
            });
        </script>

    </body>

</html>